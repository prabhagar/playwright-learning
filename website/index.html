<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playwright Learning - Demo App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            margin: 0;
            font-size: 2.5em;
        }

        header p {
            margin-top: 10px;
            opacity: 0.9;
        }

        nav {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            flex-wrap: wrap;
        }

        nav a, nav button {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        nav a:hover, nav button:hover {
            background: #e9ecef;
            border-bottom-color: #667eea;
        }

        .content {
            padding: 40px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hero {
            text-align: center;
            margin-bottom: 40px;
        }

        .hero h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 2em;
        }

        .hero p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        button, a.button {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .input-group {
            margin-bottom: 20px;
        }

        input[type="text"],
        input[type="email"],
        input[type="password"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            font-family: inherit;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        input[type="password"]:focus,
        input[type="number"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .alert {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
        }

        .alert.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table thead {
            background: #f8f9fa;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        .table tbody tr:hover {
            background: #f8f9fa;
        }

        .card {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .card p {
            color: #666;
            line-height: 1.6;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .checkbox-group,
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        input[type="checkbox"],
        input[type="radio"] {
            margin-right: 8px;
            cursor: pointer;
        }

        .checkbox-group label,
        .radio-group label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: normal;
        }

        .loader {
            display: none;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .users-list {
            margin-top: 20px;
        }

        .user-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .user-email {
            color: #666;
            font-size: 0.9em;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #333;
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .close-btn {
            background: #fc5767;
            color: white;
        }

        .close-btn:hover {
            background: #e74555;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            color: #667eea;
            text-decoration: underline;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9em;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        footer {
            background: #f8f9fa;
            border-top: 1px solid #ddd;
            padding: 20px;
            text-align: center;
            color: #666;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .status-online {
            background: #28a745;
        }

        .status-offline {
            background: #dc3545;
        }

        .status-idle {
            background: #ffc107;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            nav a, nav button {
                padding: 12px 10px;
                font-size: 0.9em;
            }

            .content {
                padding: 20px;
            }

            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé≠ Playwright Learning Lab</h1>
            <p>Master automation testing step by step</p>
            <div id="authArea" style="position:absolute;right:20px;top:30px"></div>
        </header>

        <nav>
            <a href="#" onclick="showSection('home'); return false;" class="nav-link active">Home</a>
            <a href="#" onclick="showSection('forms'); return false;" class="nav-link">Forms</a>
            <a href="#" onclick="showSection('tables'); return false;" class="nav-link">Tables</a>
            <a href="#" onclick="showSection('modals'); return false;" class="nav-link">Modals</a>
            <a href="#" onclick="showSection('async'); return false;" class="nav-link">Async Tasks</a>
            <a href="#" onclick="showSection('users'); return false;" class="nav-link">Users API</a>
        </nav>

        <div class="content">
            <!-- HOME SECTION -->
            <div id="home" class="section active">
                <div class="hero">
                    <h2>Welcome to Playwright Testing!</h2>
                    <p>This is a feature-rich demo application designed to teach you Playwright automation.</p>
                    <p>Navigate through different sections to explore various testing scenarios.</p>
                </div>

                <div class="grid">
                    <div class="card">
                        <h3>üéØ Forms Testing</h3>
                        <p>Learn to interact with form elements, input fields, and validate user interactions.</p>
                    </div>
                    <div class="card">
                        <h3>üìä Tables & Data</h3>
                        <p>Master table navigation, data extraction, and dynamic content handling.</p>
                    </div>
                    <div class="card">
                        <h3>üî≤ Modal Dialogs</h3>
                        <p>Understand how to work with pop-ups, modals, and overlays.</p>
                    </div>
                    <div class="card">
                        <h3>‚è±Ô∏è Async Operations</h3>
                        <p>Handle asynchronous operations, waiting strategies, and dynamic content loading.</p>
                    </div>
                    <div class="card">
                        <h3>üîó API Integration</h3>
                        <p>Learn API testing, mock responses, and network interception.</p>
                    </div>
                    <div class="card">
                        <h3>üß™ Advanced Patterns</h3>
                        <p>Explore fixtures, page objects, and test best practices.</p>
                    </div>
                </div>
            </div>

            <!-- FORMS SECTION -->
            <div id="forms" class="section">
                <h2 style="color: #667eea; margin-bottom: 20px;">Form Testing</h2>
                
                <div id="formAlert" class="alert"></div>

                <form id="testForm">
                    <div class="form-group">
                        <label for="firstName">First Name:</label>
                        <input type="text" id="firstName" name="firstName" placeholder="Enter your first name" required>
                    </div>

                    <div class="form-group">
                        <label for="lastName">Last Name:</label>
                        <input type="text" id="lastName" name="lastName" placeholder="Enter your last name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" name="email" placeholder="Enter your email" required>
                    </div>

                    <div class="form-group">
                        <label for="password">Password:</label>
                        <input type="password" id="password" name="password" placeholder="Enter your password" required>
                    </div>

                    <div class="form-group">
                        <label for="country">Country:</label>
                        <select id="country" name="country" required>
                            <option value="">Select a country</option>
                            <option value="usa">United States</option>
                            <option value="uk">United Kingdom</option>
                            <option value="canada">Canada</option>
                            <option value="india">India</option>
                            <option value="australia">Australia</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Gender:</label>
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="gender" value="male" required>
                                Male
                            </label>
                            <label>
                                <input type="radio" name="gender" value="female" required>
                                Female
                            </label>
                            <label>
                                <input type="radio" name="gender" value="other" required>
                                Other
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" name="subscribe" id="subscribe" value="yes">
                                Subscribe to newsletter
                            </label>
                            <label>
                                <input type="checkbox" name="terms" id="terms" value="agree" required>
                                I agree to terms and conditions
                            </label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="comments">Comments:</label>
                        <textarea id="comments" name="comments" rows="4" placeholder="Enter any additional comments"></textarea>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn-primary" id="submitBtn">Submit Form</button>
                        <button type="reset" class="btn-secondary">Clear Form</button>
                    </div>
                </form>

                <div id="formData" style="margin-top: 30px; display: none;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">Submitted Data:</h3>
                    <pre id="formDataContent" style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto;"></pre>
                </div>
            </div>

            <!-- TABLES SECTION -->
            <div id="tables" class="section">
                <h2 style="color: #667eea; margin-bottom: 20px;">Tables & Data</h2>
                
                <div class="button-group">
                    <button onclick="loadTableData()" class="btn-primary" id="loadTableBtn">Load Table Data</button>
                    <button onclick="filterTable('premium')" class="btn-secondary">Show Premium</button>
                    <button onclick="filterTable('free')" class="btn-secondary">Show Free</button>
                    <button onclick="filterTable('')" class="btn-secondary">Show All</button>
                </div>

                <table class="table" id="dataTable" style="display: none;">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Plan</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                    </tbody>
                </table>

                <div id="tableEmpty" style="text-align: center; padding: 40px; color: #999;">
                    <p>Click "Load Table Data" to see the table</p>
                </div>
            </div>

            <!-- MODALS SECTION -->
            <div id="modals" class="section">
                <h2 style="color: #667eea; margin-bottom: 20px;">Modal Dialogs</h2>
                
                <div class="card">
                    <h3>Test Modal Interactions</h3>
                    <p>Click the buttons below to open modal dialogs and practice your Playwright skills.</p>
                </div>

                <div class="button-group">
                    <button onclick="openModal('successModal')" class="btn-success">Success Modal</button>
                    <button onclick="openModal('errorModal')" class="btn-danger">Error Modal</button>
                    <button onclick="openModal('inputModal')" class="btn-primary">Input Modal</button>
                    <button onclick="openModal('confirmModal')" class="btn-warning" style="background: #ffc107; color: #333;">Confirmation Modal</button>
                </div>

                <!-- Success Modal -->
                <div id="successModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">‚úÖ Success!</div>
                        <div class="modal-body">
                            <p>Your action has been completed successfully. This is a success modal dialog.</p>
                        </div>
                        <div class="modal-footer">
                            <button onclick="closeModal('successModal')" class="btn-primary">Close</button>
                        </div>
                    </div>
                </div>

                <!-- Error Modal -->
                <div id="errorModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">‚ùå Error</div>
                        <div class="modal-body">
                            <p>An error occurred during processing. Please try again later.</p>
                        </div>
                        <div class="modal-footer">
                            <button onclick="closeModal('errorModal')" class="btn-danger">Close</button>
                        </div>
                    </div>
                </div>

                <!-- Input Modal -->
                <div id="inputModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">üìù Enter Details</div>
                        <div class="modal-body">
                            <input type="text" id="modalInput" placeholder="Enter your name" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        </div>
                        <div class="modal-footer">
                            <button onclick="closeModal('inputModal')" class="btn-secondary">Cancel</button>
                            <button onclick="submitModalInput()" class="btn-primary">Submit</button>
                        </div>
                    </div>
                </div>

                <!-- Confirmation Modal -->
                <div id="confirmModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">‚ùì Confirm Action</div>
                        <div class="modal-body">
                            <p>Are you sure you want to proceed with this action?</p>
                        </div>
                        <div class="modal-footer">
                            <button onclick="closeModal('confirmModal')" class="btn-secondary">Cancel</button>
                            <button onclick="confirmAction()" class="btn-success">Confirm</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ASYNC SECTION -->
            <div id="async" class="section">
                <h2 style="color: #667eea; margin-bottom: 20px;">Async Operations</h2>
                
                <div class="card">
                    <h3>Data Loading Simulation</h3>
                    <p>Click the button to trigger an async operation. The data will load after a delay.</p>
                </div>

                <div class="button-group">
                    <button onclick="simulateAsyncLoad()" class="btn-primary" id="asyncLoadBtn">Load Data (2 seconds)</button>
                    <button onclick="clearAsyncData()" class="btn-secondary">Clear</button>
                </div>

                <div id="loadingIndicator" style="display: none; text-align: center; margin: 30px 0;">
                    <div class="loader" style="display: inline-block;"></div>
                    <p style="margin-top: 10px; color: #666;">Loading data...</p>
                </div>

                <div id="asyncData" style="display: none; margin-top: 30px;">
                    <div class="alert alert-success" style="display: block;">
                        ‚úÖ Data loaded successfully!
                    </div>
                    <pre id="asyncDataContent" style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto; margin-top: 15px;"></pre>
                </div>

                <div class="button-group" style="margin-top: 30px;">
                    <button onclick="triggerError()" class="btn-danger">Trigger Error</button>
                    <button onclick="triggerTimeout()" class="btn-warning" style="background: #ffc107; color: #333;">Trigger Timeout (5s)</button>
                </div>

                <div id="errorContainer" style="display: none; margin-top: 20px;">
                    <div class="alert alert-error" id="errorMessage" style="display: block;"></div>
                </div>
            </div>

            <!-- USERS API SECTION -->
            <div id="users" class="section">
                <h2 style="color: #667eea; margin-bottom: 20px;">Users API</h2>
                
                <div class="card">
                    <h3>Manage Users</h3>
                    <p>This section demonstrates API interactions. You can fetch, create, update, and delete users.</p>
                </div>

                <div class="button-group">
                    <button onclick="fetchAllUsers()" class="btn-primary" id="fetchUsersBtn">Fetch All Users</button>
                    <button onclick="openCreateUserModal()" class="btn-success">Create New User</button>
                </div>

                <div id="usersList" class="users-list"></div>

                <!-- Create User Modal -->
                <div id="createUserModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">‚ûï Create New User</div>
                        <div class="modal-body">
                            <input type="text" id="newUserName" placeholder="Name" style="width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            <input type="email" id="newUserEmail" placeholder="Email" style="width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            <select id="newUserRole" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="user">User</option>
                                <option value="admin">Admin</option>
                                <option value="moderator">Moderator</option>
                            </select>
                        </div>
                        <div class="modal-footer">
                            <button onclick="closeModal('createUserModal')" class="btn-secondary">Cancel</button>
                            <button onclick="createUser()" class="btn-success">Create</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>Playwright Learning Lab ¬© 2025 | Build your automation skills today</p>
        </footer>
    </div>

    <script>
        // ========== NAVIGATION ==========
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.remove('active'));

            // Show selected section
            const selectedSection = document.getElementById(sectionId);
            if (selectedSection) {
                selectedSection.classList.add('active');
            }

            // Update nav links
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            event.target.classList.add('active');
        }

        // ========== FORMS ==========
        document.getElementById('testForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = new FormData(this);
            const data = Object.fromEntries(formData);

            // Validate
            if (!data.firstName || !data.lastName || !data.email) {
                showAlert('formAlert', 'Please fill all required fields', 'error');
                return;
            }

            if (!data.email.includes('@')) {
                showAlert('formAlert', 'Please enter a valid email', 'error');
                return;
            }

            if (data.password.length < 6) {
                showAlert('formAlert', 'Password must be at least 6 characters', 'error');
                return;
            }

            // Success
            showAlert('formAlert', 'Form submitted successfully!', 'success');
            document.getElementById('formDataContent').textContent = JSON.stringify(data, null, 2);
            document.getElementById('formData').style.display = 'block';
        });

        // ========== TABLES ==========
        const sampleData = [
            { id: 1, name: 'Alice Johnson', email: 'alice@example.com', plan: 'Premium', status: 'Active' },
            { id: 2, name: 'Bob Smith', email: 'bob@example.com', plan: 'Free', status: 'Active' },
            { id: 3, name: 'Carol White', email: 'carol@example.com', plan: 'Premium', status: 'Inactive' },
            { id: 4, name: 'David Brown', email: 'david@example.com', plan: 'Free', status: 'Active' },
            { id: 5, name: 'Emma Davis', email: 'emma@example.com', plan: 'Premium', status: 'Active' },
        ];

        function loadTableData() {
            const tableBody = document.getElementById('tableBody');
            const table = document.getElementById('dataTable');
            const empty = document.getElementById('tableEmpty');

            tableBody.innerHTML = '';
            table.style.display = 'table';
            empty.style.display = 'none';

            sampleData.forEach(row => {
                const tr = document.createElement('tr');
                tr.className = `row-${row.plan.toLowerCase()}`;
                tr.innerHTML = `
                    <td>${row.id}</td>
                    <td>${row.name}</td>
                    <td>${row.email}</td>
                    <td>${row.plan}</td>
                    <td><span class="status-indicator status-${row.status.toLowerCase()}"></span>${row.status}</td>
                    <td><button onclick="editRow(${row.id})" class="btn-secondary" style="padding: 5px 10px; font-size: 0.9em;">Edit</button></td>
                `;
                tableBody.appendChild(tr);
            });
        }

        function filterTable(plan) {
            const rows = document.querySelectorAll('#tableBody tr');
            rows.forEach(row => {
                if (plan === '') {
                    row.style.display = '';
                } else {
                    row.style.display = row.className.includes(`row-${plan}`) ? '' : 'none';
                }
            });
        }

        function editRow(id) {
            showAlert('formAlert', `Editing row ${id}. This would open an edit modal in a real app.`, 'info');
        }

        // ========== MODALS ==========
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('show');
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('show');
            }
        }

        function submitModalInput() {
            const input = document.getElementById('modalInput').value;
            if (input.trim()) {
                showAlert('formAlert', `Input received: "${input}"`, 'success');
                closeModal('inputModal');
                document.getElementById('modalInput').value = '';
            }
        }

        function confirmAction() {
            showAlert('formAlert', 'Action confirmed!', 'success');
            closeModal('confirmModal');
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
            }
        }

        // ========== ASYNC OPERATIONS ==========
        function simulateAsyncLoad() {
            document.getElementById('loadingIndicator').style.display = 'block';
            document.getElementById('asyncData').style.display = 'none';
            document.getElementById('errorContainer').style.display = 'none';
            document.getElementById('asyncLoadBtn').disabled = true;

            setTimeout(() => {
                const data = {
                    timestamp: new Date().toISOString(),
                    message: 'Data loaded successfully',
                    records: [
                        { id: 1, value: 'Item 1' },
                        { id: 2, value: 'Item 2' },
                        { id: 3, value: 'Item 3' }
                    ]
                };

                document.getElementById('asyncDataContent').textContent = JSON.stringify(data, null, 2);
                document.getElementById('loadingIndicator').style.display = 'none';
                document.getElementById('asyncData').style.display = 'block';
                document.getElementById('asyncLoadBtn').disabled = false;
            }, 2000);
        }

        function clearAsyncData() {
            document.getElementById('loadingIndicator').style.display = 'none';
            document.getElementById('asyncData').style.display = 'none';
            document.getElementById('errorContainer').style.display = 'none';
            document.getElementById('asyncLoadBtn').disabled = false;
        }

        function triggerError() {
            document.getElementById('errorMessage').textContent = '‚ùå An error occurred: Failed to load data. Please try again.';
            document.getElementById('errorContainer').style.display = 'block';
            document.getElementById('asyncData').style.display = 'none';
            document.getElementById('loadingIndicator').style.display = 'none';
        }

        function triggerTimeout() {
            document.getElementById('errorMessage').textContent = '‚è±Ô∏è Request timeout: The operation took too long to complete. Timeout: 5 seconds.';
            document.getElementById('errorContainer').style.display = 'block';
            document.getElementById('asyncData').style.display = 'none';
            document.getElementById('loadingIndicator').style.display = 'none';
        }

        // ========== USERS API ==========
        let users = [
            { id: 1, name: 'John Admin', email: 'john@example.com', role: 'admin', status: 'active' },
            { id: 2, name: 'Jane User', email: 'jane@example.com', role: 'user', status: 'active' },
            { id: 3, name: 'Bob Moderator', email: 'bob@example.com', role: 'moderator', status: 'inactive' },
        ];

        function fetchAllUsers() {
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = '';

            if (users.length === 0) {
                usersList.innerHTML = '<p style="text-align: center; color: #999; padding: 20px;">No users found</p>';
                return;
            }

            users.forEach(user => {
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                userItem.innerHTML = `
                    <div class="user-info">
                        <div class="user-name">${user.name}</div>
                        <div class="user-email">${user.email}</div>
                        <small style="color: #999;">Role: ${user.role} | Status: ${user.status}</small>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="editUser(${user.id})" class="btn-secondary" style="padding: 8px 12px; font-size: 0.85em;">Edit</button>
                        <button onclick="deleteUser(${user.id})" class="btn-danger" style="padding: 8px 12px; font-size: 0.85em;">Delete</button>
                    </div>
                `;
                usersList.appendChild(userItem);
            });
        }

        function openCreateUserModal() {
            openModal('createUserModal');
        }

        function createUser() {
            const name = document.getElementById('newUserName').value;
            const email = document.getElementById('newUserEmail').value;
            const role = document.getElementById('newUserRole').value;

            if (!name || !email) {
                alert('Please fill all fields');
                return;
            }

            const newUser = {
                id: Math.max(...users.map(u => u.id), 0) + 1,
                name,
                email,
                role,
                status: 'active'
            };

            users.push(newUser);
            showAlert('formAlert', `User "${name}" created successfully!`, 'success');
            closeModal('createUserModal');
            document.getElementById('newUserName').value = '';
            document.getElementById('newUserEmail').value = '';
            fetchAllUsers();
        }

        function editUser(id) {
            showAlert('formAlert', `Editing user ${id}. This would open an edit form in a real app.`, 'info');
        }

        function deleteUser(id) {
            users = users.filter(u => u.id !== id);
            showAlert('formAlert', `User deleted successfully!`, 'success');
            fetchAllUsers();
        }

        // ========== UTILITIES ==========
        function showAlert(elementId, message, type) {
            const alert = document.getElementById(elementId);
            if (alert) {
                alert.textContent = message;
                alert.className = `alert alert-${type} show`;
                setTimeout(() => {
                    alert.classList.remove('show');
                }, 5000);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Page loaded. Ready for testing!');
            // If a logged-in user was saved in localStorage by the login page,
            // show a logout button so tests using storageState can detect it.
            const u = localStorage.getItem('loggedInUser');
            if (u) {
                const authArea = document.getElementById('authArea');
                if (authArea && !document.getElementById('logout')) {
                    const btn = document.createElement('button');
                    btn.id = 'logout';
                    btn.textContent = 'Logout';
                    btn.style.padding = '8px 12px';
                    btn.style.borderRadius = '6px';
                    btn.style.border = '1px solid #ddd';
                    btn.style.background = '#fff';
                    btn.addEventListener('click', () => { localStorage.removeItem('loggedInUser'); btn.remove(); });
                    authArea.appendChild(btn);
                }
            }
        });
    </script>
</body>
</html>
